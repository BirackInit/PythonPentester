import scapy.all as scapy
import threading

def scannerHost(ipv4, results):
    arp_request = scapy.ARP(pdst=ipv4)
    broadcast = scapy.Ether(dst="ff:ff:ff:ff:ff:ff")
    arp_request_broadcast = broadcast / arp_request
    answered_list = scapy.srp(arp_request_broadcast, timeout=1, verbose=False)[0]

    for element in answered_list:
        result = {"ipv4": element[1].psrc, "mac": element[1].hwsrc}
        results.append(result)

def Results(results):
    print("IP Address\tMAC Address")
    print("--------------------------------------------")
    for result in results:
        print(f"{result['ipv4']}\t{result['mac']}")

IP_DE_VICTIME = "192.168.10.0/24"
results = []
scannerHostThread = threading.Thread(target=scannerHost, args=(IP_DE_VICTIME, results))
scannerHostThread.start()
scannerHostThread.join()
Results(results)

