from flask import Flask, request, render_template_string, redirect, url_for, session
from flask_session import Session

app = Flask(__name__)
app.secret_key = '2029240f6d1128be89ddc32729463129'
app.config["SESSION_PERMANENT"] = False
app.config["SESSION_TYPE"] = "filesystem"
Session(app)

HTML_FORM = '''
<!DOCTYPE html>
<html>
<head>
    <title>Login Page</title>
</head>
<body>
    {% if session.get('username') %}
    <p>Bienvenue, Hacker Éthique débutant, {{ session.username }}! <a href="/logout">Logout</a></p>
    {% else %}
    <h2>Login</h2>
    <form method="post">
        Username: <input type="text" name="username"><br>
        Password: <input type="password" name="password"><br>
        <input type="submit" value="Login">
    </form>
    {% endif %}
</body>
</html>
'''

@app.route('/')
def home():
    return render_template_string(HTML_FORM)

@app.route('/', methods=['POST'])
def login():
    username = request.form.get('username')
    password = request.form.get('password')
    if username == "Hassan" and password == "password":
        session['username'] = username
        return redirect(url_for('home'))
    else:
        return "Wrong username or password!"

@app.route('/logout')
def logout():
    session.pop('username', None)
    return redirect(url_for('home'))

if __name__ == '__main__':
    app.run(debug=True)
